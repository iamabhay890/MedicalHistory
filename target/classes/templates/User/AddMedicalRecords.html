<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">
<head>
    <title>User Profile</title>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <link href="https://use.fontawesome.com/releases/v5.10.2/css/all.css" rel="stylesheet"/>
    <!-- Bootstrap CSS -->
    <link href="https://www.markuptag.com/bootstrap/5/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
        .img-fluid{
        height:40px;
        }

     .btnl a{
    color : White;
    font-weight: bold;
    text-decoration: none;
     }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
    <link rel="stylesheet"  th:href="@{/css/tokenStyle.css}">
</head>
<body>
<header th:replace="User/userBlock::header1"></header>

<section>
    <div class="container">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <form class="mt-2" method="post" th:action="@{/mh/user/records/addUserMedicalRecords}"
                      th:object="${patientDto}">
                    <h2 style="color: White">Patient Registration</h2>

                    <!--.........................Disease Name................-->
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" style="padding-right:40px">Disease Name</span>
                        </div>
                        <input aria-describedby="inputGroup-sizing-default" aria-label="Default"
                               class="form-control"
                               placeholder="Enter Disease Name"
                               th:classappend="${#fields.hasErrors('diseaseName')}?'is-invalid':''"
                               th:field="*{diseaseName}"
                               th:value="${patientDto.diseaseName}"
                               type="text"
                        />
                        <div align="left" class="invalid-feedback"
                             th:each="e:${#fields.errors('diseaseName')}" th:text="${e}">
                        </div>
                    </div>

                    <!--..........................Hospital Name.............................-->
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" style="padding-right:35px">Hospital Name</span>
                        </div>
                        <input aria-describedby="inputGroup-sizing-default" aria-label="Default"
                               class="form-control"
                               placeholder="Enter Hospital Name"
                               th:classappend="${#fields.hasErrors('hospitalName')}?'is-invalid':''"
                               th:field="*{hospitalName}"
                               th:value="${patientDto.hospitalName}"
                               type="text"
                        />
                        <div align="left" class="invalid-feedback"
                             th:each="e:${#fields.errors('hospitalName')}" th:text="${e}">
                        </div>
                    </div>
                    <!--..........................Doctor Name-->
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" style="padding-right:45px">Doctor Name</span>
                        </div>
                        <input aria-describedby="inputGroup-sizing-default" aria-label="Default" class="form-control"
                               placeholder="Enter your Doctor Name"
                               th:classappend="${#fields.hasErrors('doctorName')}?'is-invalid':''"
                               th:field="*{doctorName}"
                               th:value="${patientDto.doctorName}"
                               type="text"
                        />
                        <div align="left" class="invalid-feedback"
                             th:each="e:${#fields.errors('doctorName')}" th:text="${e}">
                        </div>
                    </div>


                     <!-- ............ ............Add Medicine.......................-->
                     <div class="input-group mb-3">
                        <div class="input-group-prepend" >
                            <span class="input-group-text" style="padding-right:70px">Medicines</span>
                        </div>
                            <input id="search-input"
                                   class="form-control"
                                   name="search-input"
                                   placeholder="Add Medicine"
                                   type="text"
                                   th:field="*{medicineName}"/>
<!--                            <a onclick="addMore()" class="btn btn-success" >+</a>-->
                        </div>

             
                    <!--........................................Report-->
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" style="padding-right:93px"> Report</span>
                        </div>
                        <input aria-describedby="inputGroup-sizing-default" aria-label="Default" class="form-control"
                               placeholder="Enter your Report Here"
                               th:field="*{report}"
                               th:value="${patientDto.report}"
                               type="text"
                        />
                    </div>


                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" style="padding-right:32px">Type of Disease</span>
                        </div>
                        <input aria-describedby="inputGroup-sizing-default" aria-label="Default" class="form-control"
                               placeholder="Enter your type of disease"
                               th:field="*{typeOfDisease}"
                               th:value="${patientDto.typeOfDisease}"
                               type="text"
                        />
                    </div>

                    <div class="input-group mb-3" style="margin-top:10px">
                        <div class="input-group-prepend">
                            <span class="input-group-text" style="padding-right:32px">Treatment Date</span>
                        </div>
                        <input class="form-control" id="date_picker_forward_disable"
                               name="date"
                               th:field="*{treatmentDate}"
                               th:value="${patientDto.treatmentDate}"
                               type="date"
                        />
                        <span class="validity"></span>

                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" style="padding-right:12px">Next Appointment</span>
                        </div>
                        <input class="form-control"
                               id="date_picker_previous_disable"
                               name="date"
                               th:field="*{nexAppt}"
                               th:value="${patientDto.nexAppt}"
                               type="date"
                        />
                        <span class="validity"></span>
                    </div>

                    <input th:field="*{id}" th:object="${userDto}" type="hidden"/>

                    <button class="btn btn-success" style="margin-top:10px">Create</button>

                </form>

            </div>
        </div>
    </div>
</section>
<!-- Bootstrap JS -->
<script src="https://www.markuptag.com/bootstrap/5/js/bootstrap.bundle.min.js"></script>


<!--This will disable the previous and forward in date picker date-->
<script language="javascript">
        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth() + 1).padStart(2, '0');
        var yyyy = today.getFullYear();

        today = yyyy + '-' + mm + '-' + dd;
        $('#date_picker_previous_disable').attr('min',today);
        $('#date_picker_forward_disable').attr('max',today)


</script>
<script type="text/javascript" th:src="@{/Js/script.js}"></script>
<script type="text/javascript" th:src="@{/Js/tokenScript.js}"></script>
<script>

let medicine=[];
fetchMedicine();
function fetchMedicine(){
    fetch("/searchAll")
    .then((response)=>response.json())
    .then((data)=>{
       medicine=data.map((x)=>x.name);
            medicine.sort();

             find(medicine);
    });
}

 function find(medicine){
  console.log(medicine);
    $('#search-input').tokenfield({
  autocomplete:{
   source: medicine,
   delay:100
  },
  showAutocompleteOnFocus: true
 })
 }
</script>
</body>
</html>